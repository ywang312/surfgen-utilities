(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36010,        776]
NotebookOptionsPosition[     35144,        756]
NotebookOutlinePosition[     35576,        773]
CellTagsIndexPosition[     35533,        770]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"FileNames", "[", 
  "\"\</Users/yuchenwang/Workspace/trajectories/sharc/12302021/*.xyz\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6405161421144733`*^9, 3.640516160435484*^9}, 
   3.640516240938223*^9, {3.652798927327756*^9, 3.652798927550613*^9}, 
   3.762043984632721*^9, {3.823908664357237*^9, 3.823908673994512*^9}, {
   3.823908735907584*^9, 3.823908757937353*^9}, {3.82430275233946*^9, 
   3.824302776926022*^9}, 3.8243055077516108`*^9, {3.824313665849935*^9, 
   3.8243136790122843`*^9}, {3.845678610248434*^9, 3.845678648419174*^9}, {
   3.847373995097712*^9, 3.847373996533614*^9}, {3.84737403927789*^9, 
   3.8473740451790667`*^9}, {3.8510945393878508`*^9, 3.8510945419796*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"32e02df5-b096-4465-93b2-98338af06d33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trajdatasharc", "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ImportString", "[", 
        RowBox[{
         RowBox[{"ExportString", "[", 
          RowBox[{"#", ",", "\"\<Table\>\""}], "]"}], ",", "\"\<xyz\>\""}], 
        "]"}], "&"}], "/@", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
           "\"\</Users/yuchenwang/Workspace/trajectories/sharc/12302021/\
cutoff1.xyz\>\"", ",", "\"\<Text\>\""}], "]"}], ",", "\"\<\\n\>\""}], "]"}], 
        ",", "6"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.824315008868723*^9, 3.824315098769129*^9}, {
   3.824316076984808*^9, 3.824316083471944*^9}, {3.8243164374213333`*^9, 
   3.824316478809697*^9}, {3.8243165090980797`*^9, 3.824316521624518*^9}, {
   3.8243166151600027`*^9, 3.824316622749497*^9}, {3.824317186673229*^9, 
   3.824317194086692*^9}, {3.824317225741844*^9, 3.824317271862875*^9}, 
   3.8243173146866198`*^9, {3.84567865526156*^9, 3.845678667597782*^9}, {
   3.84737415057054*^9, 3.847374154716722*^9}, {3.849916575342882*^9, 
   3.849916581575756*^9}, {3.849916658447152*^9, 3.849916675833332*^9}, {
   3.8499167090736094`*^9, 3.849916730976906*^9}, {3.849916867466772*^9, 
   3.849916874543632*^9}, {3.8499484916558247`*^9, 3.849948520647726*^9}, {
   3.849948662696513*^9, 3.849948667930277*^9}, {3.84995032859118*^9, 
   3.84995033146244*^9}, {3.8499505013872433`*^9, 3.8499505049512863`*^9}, {
   3.849950612469224*^9, 3.849950615206602*^9}, {3.8499512526830187`*^9, 
   3.849951255062191*^9}, {3.850516668092207*^9, 3.850516673882936*^9}, {
   3.8505184766577587`*^9, 3.8505184810646343`*^9}, {3.8505195646040916`*^9, 
   3.85051956790432*^9}, {3.8505220242444363`*^9, 3.850522038257142*^9}, {
   3.85052308476836*^9, 3.850523087737075*^9}, {3.8505543194898567`*^9, 
   3.850554319801366*^9}, 3.85055436750526*^9, {3.850554506825761*^9, 
   3.850554510444125*^9}, {3.850554562270215*^9, 3.850554564826933*^9}, {
   3.850554840268237*^9, 3.850554841191811*^9}, {3.850554934054991*^9, 
   3.850554937507061*^9}, {3.850555140481254*^9, 3.8505551436043262`*^9}, {
   3.850555187706811*^9, 3.850555189962199*^9}, {3.850555675714254*^9, 
   3.8505556872406693`*^9}, 3.850860713031546*^9, {3.850860801409664*^9, 
   3.8508608229131317`*^9}, {3.850860915513607*^9, 3.8508609190078993`*^9}, {
   3.850861221125766*^9, 3.8508612215675573`*^9}, {3.8508616026382627`*^9, 
   3.8508616032793703`*^9}, {3.85086166477092*^9, 3.8508616708601294`*^9}, {
   3.850861741326561*^9, 3.850861746860989*^9}, 3.851094566388712*^9, 
   3.85109506588288*^9, {3.85109530374927*^9, 3.851095310857214*^9}, {
   3.851095355395111*^9, 3.851095375530203*^9}, 3.851098217927244*^9, 
   3.853463583803117*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"4e72673f-7a16-4820-9b8a-5d909411c084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energysharc", "=", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\</Users/yuchenwang/Workspace/trajectories/sharc/12302021/plot1.out\>\
\"", ",", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "4"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tsh", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e1sh", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e2sh", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e3sh", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"currsh", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labelsh", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"distsh", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"socsh", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "energysharc", "]"}], "[", 
    RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"distmat", "=", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DistanceMatrix", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"ImportString", "[", 
                   RowBox[{
                    RowBox[{"ExportString", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    "\"\</Users/yuchenwang/Workspace/trajectories/sharc/\
12302021/cutoff1.xyz\>\"", ",", "\"\<Text\>\""}], "]"}], ",", "\"\<\\n\>\""}],
                     "]"}], ",", "6"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<Table\>\""}], 
                    "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "6"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"Import", "[", 
           RowBox[{
           "\"\</Users/yuchenwang/Workspace/trajectories/sharc/12302021/plot1.\
out\>\"", ",", "\"\<Lines\>\""}], "]"}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}], ",", "4"}], "}"}]}], "]"}], "*", "1.8897"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.824315008868723*^9, 3.824315098769129*^9}, {
   3.824316076984808*^9, 3.824316083471944*^9}, {3.8243164374213333`*^9, 
   3.824316478809697*^9}, {3.8243165090980797`*^9, 3.824316521624518*^9}, {
   3.8243166151600027`*^9, 3.824316622749497*^9}, {3.824317186673229*^9, 
   3.824317194086692*^9}, {3.824317225741844*^9, 3.824317271862875*^9}, 
   3.8243173146866198`*^9, {3.84567865526156*^9, 3.845678667597782*^9}, {
   3.84737415057054*^9, 3.847374154716722*^9}, {3.849916575342882*^9, 
   3.849916581575756*^9}, {3.849916658447152*^9, 3.849916675833332*^9}, {
   3.8499167090736094`*^9, 3.849916730976906*^9}, {3.849916867466772*^9, 
   3.849916874543632*^9}, {3.8499484916558247`*^9, 3.849948520647726*^9}, {
   3.849948662696513*^9, 3.849948667930277*^9}, {3.84995032859118*^9, 
   3.84995033146244*^9}, {3.8499505013872433`*^9, 3.8499505049512863`*^9}, {
   3.849950612469224*^9, 3.849950615206602*^9}, {3.8499512526830187`*^9, 
   3.849951255062191*^9}, {3.850516668092207*^9, 3.850516673882936*^9}, {
   3.8505184766577587`*^9, 3.8505184810646343`*^9}, {3.8505195646040916`*^9, 
   3.85051956790432*^9}, {3.8505220242444363`*^9, 3.850522038257142*^9}, {
   3.85052308476836*^9, 3.850523087737075*^9}, {3.8505543194898567`*^9, 
   3.850554319801366*^9}, 3.85055436750526*^9, {3.850554506825761*^9, 
   3.850554510444125*^9}, {3.850554562270215*^9, 3.850554564826933*^9}, {
   3.850554840268237*^9, 3.850554841191811*^9}, {3.850554934054991*^9, 
   3.850554937507061*^9}, {3.850555140481254*^9, 3.8505551436043262`*^9}, {
   3.850555187706811*^9, 3.850555189962199*^9}, {3.850555675714254*^9, 
   3.8505556872406693`*^9}, 3.850860713031546*^9, {3.850860801409664*^9, 
   3.8508608229131317`*^9}, {3.850860915513607*^9, 3.8508609190078993`*^9}, {
   3.850861221125766*^9, 3.8508612215675573`*^9}, {3.8508616026382627`*^9, 
   3.8508616032793703`*^9}, {3.85086166477092*^9, 3.8508616708601294`*^9}, {
   3.850861741326561*^9, 3.850861746860989*^9}, 3.851094566388712*^9, 
   3.85109506588288*^9, {3.85109530374927*^9, 3.851095310857214*^9}, {
   3.851095355395111*^9, 3.851095375530203*^9}, 3.851098217927244*^9, 
   3.853463583803117*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"1d9c353e-8a9b-44f5-aded-fb9e2bd6a438"],

Cell[BoxData[
 RowBox[{"pp1", "=", 
  RowBox[{"ListAnimate", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MoleculePlot3D", "[", 
            RowBox[{
             RowBox[{"trajdatasharc", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"ViewPoint", " ", "->", " ", "Top"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
           RowBox[{"MoleculePlot3D", "[", 
            RowBox[{
             RowBox[{"trajdatasharc", "[", 
              RowBox[{"[", 
               RowBox[{"Length", "[", "trajdatasharc", "]"}], "]"}], "]"}], 
             ",", " ", 
             RowBox[{"ViewPoint", " ", "->", " ", "Top"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], " ", "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"tsh", ",", " ", "e1sh"}], "}"}], "]"}], ",", " ", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"tsh", ",", " ", "e2sh"}], "}"}], "]"}], ",", " ", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"tsh", ",", " ", "e3sh"}], "}"}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"GridLines", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"tsh", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"True", ",", "True"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", " ", 
             RowBox[{"FrameLabel", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<energy(\!\(\*SuperscriptBox[\(cm\), \(-1\)]\))\>\"", 
                  ",", "None"}], "}"}], ",", 
                RowBox[{"{", " ", 
                 RowBox[{"\"\<Time(fs)\>\"", ",", "None"}], "}"}]}], "}"}]}], 
             " ", ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Bold", ",", " ", "18"}], "]"}]}], ",", " ", 
             RowBox[{"PlotLegends", " ", "->", " ", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<S0\>\"", ",", " ", "\"\<S1\>\"", ",", " ", 
                  "\"\<T1\>\""}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.6", ",", "1.0"}], "}"}]}], "]"}]}], ",", " ", 
             RowBox[{"Epilog", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", "Large", "]"}], ",", " ", 
                RowBox[{"Point", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"tsh", ",", " ", "currsh"}], "}"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"tsh", ",", " ", 
                  RowBox[{
                   RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"tsh", ",", " ", 
                  RowBox[{
                   RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"GridLines", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"tsh", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"True", ",", "True"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", " ", 
             RowBox[{"FrameLabel", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<r(N-H)(Bohr)\>\"", ",", "None"}], "}"}], ",", 
                RowBox[{"{", " ", 
                 RowBox[{"\"\<Time(fs)\>\"", ",", "None"}], "}"}]}], "}"}]}], 
             " ", ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Bold", ",", " ", "18"}], "]"}]}], ",", "  ", 
             RowBox[{"Epilog", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", "Large", "]"}], ",", " ", 
                RowBox[{"Point", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{"tsh", ",", " ", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "}"}]}], 
        "}"}], ",", " ", 
       RowBox[{"Frame", " ", "->", " ", "All"}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"\"\<current state= \>\"", "<>", 
                RowBox[{"labelsh", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", "20"}], "]"}], "]"}], 
            ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.95"}], "}"}], "]"}]}], "]"}], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"tsh", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "20"}], "]"}], "]"}], 
            ",", 
            RowBox[{"ImageScaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.85"}], "}"}], "]"}]}], "]"}]}], "}"}]}], 
       ",", 
       RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", "tsh", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.824315008868723*^9, 3.824315098769129*^9}, {
   3.824316076984808*^9, 3.824316083471944*^9}, {3.8243164374213333`*^9, 
   3.824316478809697*^9}, {3.8243165090980797`*^9, 3.824316521624518*^9}, {
   3.8243166151600027`*^9, 3.824316622749497*^9}, {3.824317186673229*^9, 
   3.824317194086692*^9}, {3.824317225741844*^9, 3.824317271862875*^9}, 
   3.8243173146866198`*^9, {3.84567865526156*^9, 3.845678667597782*^9}, {
   3.84737415057054*^9, 3.847374154716722*^9}, {3.849916575342882*^9, 
   3.849916581575756*^9}, {3.849916658447152*^9, 3.849916675833332*^9}, {
   3.8499167090736094`*^9, 3.849916730976906*^9}, {3.849916867466772*^9, 
   3.849916874543632*^9}, {3.8499484916558247`*^9, 3.849948520647726*^9}, {
   3.849948662696513*^9, 3.849948667930277*^9}, {3.84995032859118*^9, 
   3.84995033146244*^9}, {3.8499505013872433`*^9, 3.8499505049512863`*^9}, {
   3.849950612469224*^9, 3.849950615206602*^9}, {3.8499512526830187`*^9, 
   3.849951255062191*^9}, {3.850516668092207*^9, 3.850516673882936*^9}, {
   3.8505184766577587`*^9, 3.8505184810646343`*^9}, {3.8505195646040916`*^9, 
   3.85051956790432*^9}, {3.8505220242444363`*^9, 3.850522038257142*^9}, {
   3.85052308476836*^9, 3.850523087737075*^9}, {3.8505543194898567`*^9, 
   3.850554319801366*^9}, 3.85055436750526*^9, {3.850554506825761*^9, 
   3.850554510444125*^9}, {3.850554562270215*^9, 3.850554564826933*^9}, {
   3.850554840268237*^9, 3.850554841191811*^9}, {3.850554934054991*^9, 
   3.850554937507061*^9}, {3.850555140481254*^9, 3.8505551436043262`*^9}, {
   3.850555187706811*^9, 3.850555189962199*^9}, {3.850555675714254*^9, 
   3.8505556872406693`*^9}, 3.850860713031546*^9, {3.850860801409664*^9, 
   3.8508608229131317`*^9}, {3.850860915513607*^9, 3.8508609190078993`*^9}, {
   3.850861221125766*^9, 3.8508612215675573`*^9}, {3.8508616026382627`*^9, 
   3.8508616032793703`*^9}, {3.85086166477092*^9, 3.8508616708601294`*^9}, {
   3.850861741326561*^9, 3.850861746860989*^9}, 3.851094566388712*^9, 
   3.8510975538468103`*^9, {3.8510977217256947`*^9, 3.851097773741391*^9}, 
   3.8510978558817368`*^9, {3.851097903614479*^9, 3.851098003004902*^9}, {
   3.851098101260578*^9, 3.851098189462113*^9}, {3.851098249181018*^9, 
   3.85109825632154*^9}, {3.851098316482279*^9, 3.8510983301745987`*^9}, {
   3.851098397194018*^9, 3.8510984042180357`*^9}, {3.851098480191094*^9, 
   3.851098482468038*^9}, {3.8527357964491253`*^9, 3.8527358082056513`*^9}, 
   3.852735958179435*^9, {3.852736089237507*^9, 3.852736113300549*^9}, {
   3.852736215109127*^9, 3.852736215593947*^9}, {3.852759991709927*^9, 
   3.852759993872652*^9}, {3.852760036369*^9, 3.852760082108408*^9}, 
   3.852760199188964*^9, {3.8527611138862257`*^9, 3.8527611729479837`*^9}, {
   3.8527612617255507`*^9, 3.8527613278186502`*^9}, {3.8527614059988337`*^9, 
   3.852761426710629*^9}, {3.852761474021452*^9, 3.852761480333198*^9}, {
   3.8527615405357428`*^9, 3.852761546743371*^9}, {3.852761649067255*^9, 
   3.852761649572391*^9}, {3.9073584438484783`*^9, 3.907358453238554*^9}, {
   3.9073585242635717`*^9, 3.907358531509816*^9}, 3.9073588618532257`*^9, {
   3.907358960393882*^9, 3.907358961873435*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"63646080-c82a-4dd2-a24d-0055389da5d8"],

Cell[BoxData[
 RowBox[{"p1", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MoleculePlot3D", "[", 
             RowBox[{
              RowBox[{"trajdatasharc", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              RowBox[{"ViewPoint", " ", "->", " ", "Top"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
            RowBox[{"MoleculePlot3D", "[", 
             RowBox[{
              RowBox[{"trajdatasharc", "[", 
               RowBox[{"[", 
                RowBox[{"Length", "[", "trajdatasharc", "]"}], "]"}], "]"}], 
              ",", " ", 
              RowBox[{"ViewPoint", " ", "->", " ", "Top"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], " ", "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"tsh", ",", " ", "e1sh"}], "}"}], "]"}], ",", " ", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"tsh", ",", " ", "e2sh"}], "}"}], "]"}], ",", " ", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"tsh", ",", " ", "e3sh"}], "}"}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"GridLines", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tsh", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Black"}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"26", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Black"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"116", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Black"}], 
                    "]"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}], ",", 
              RowBox[{"Frame", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"True", ",", "True"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", " ", 
              RowBox[{"FrameLabel", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<energy(\!\(\*SuperscriptBox[\(cm\), \(-1\)]\))\>\"", 
                   ",", "None"}], "}"}], ",", 
                 RowBox[{"{", " ", 
                  RowBox[{"\"\<Time(fs)\>\"", ",", "None"}], "}"}]}], "}"}]}],
               " ", ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Bold", ",", " ", "18"}], "]"}]}], ",", 
              RowBox[{"PlotLegends", " ", "->", " ", 
               RowBox[{"Placed", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", " ", 
                   "\"\<\!\(\*SubscriptBox[\(S\), \(1\)]\)\>\"", ",", " ", 
                   "\"\<\!\(\*SubscriptBox[\(T\), \(1\)]\)\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.6", ",", "1.1"}], "}"}]}], "]"}]}], ",", " ", 
              RowBox[{"Epilog", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "Large", "]"}], ",", " ", 
                 RowBox[{"Point", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"tsh", ",", " ", "currsh"}], "}"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
              RowBox[{"Prolog", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Framed", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Hop \!\(\*SubscriptBox[\(S\), \
\(1\)]\)\[Rule]\!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", "15"}], "]"}], 
                    "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.33", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
                 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Framed", "[", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Hop \!\(\*SubscriptBox[\(S\), \
\(0\)]\)\[Rule]\!\(\*SubscriptBox[\(T\), \(1\)]\)\>\"", ",", "15"}], "]"}], 
                    "]"}], ",", 
                   RowBox[{"ImageScaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.66", ",", "0.9"}], "}"}], "]"}]}], "]"}]}], 
                "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"tsh", ",", " ", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"tsh", ",", " ", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"tsh", ",", " ", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"PlotRange", "->", "Full"}], ",", 
              RowBox[{"GridLines", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tsh", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Black"}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"26", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Black"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"116", ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Black"}], 
                    "]"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}]}], ",", 
              RowBox[{"Frame", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"True", ",", "True"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"True", ",", "True"}], "}"}]}], "}"}]}], ",", " ", 
              RowBox[{"FrameLabel", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<r(N-H)(Bohr)\>\"", ",", "None"}], "}"}], ",", 
                 RowBox[{"{", " ", 
                  RowBox[{"\"\<Time(fs)\>\"", ",", "None"}], "}"}]}], "}"}]}],
               " ", ",", 
              RowBox[{"PlotLegends", " ", "->", " ", 
               RowBox[{"Placed", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(r\), \(1\)]\)\>\"", ",", " ", 
                   "\"\<\!\(\*SubscriptBox[\(r\), \(2\)]\)\>\"", ",", 
                   "\"\<\!\(\*SubscriptBox[\(r\), \(3\)]\)\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "1.0"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Bold", ",", " ", "18"}], "]"}]}], ",", "  ", 
              RowBox[{"Epilog", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "Large", "]"}], ",", " ", 
                 RowBox[{"Point", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"tsh", ",", " ", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "distmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", " ", 
        RowBox[{"Frame", " ", "->", " ", "All"}], ",", 
        RowBox[{"Epilog", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Framed", "[", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Start\>\"", ",", "30"}], "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.4", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Framed", "[", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<End\>\"", ",", "30"}], "]"}], "]"}], ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Framed", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<current state= \>\"", "<>", 
                 RowBox[{"labelsh", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", "15"}], "]"}], "]"}],
              ",", 
             RowBox[{"ImageScaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.3", ",", "0.42"}], "}"}], "]"}]}], "]"}]}], "}"}]}],
         ",", 
        RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", "tsh", "]"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.852760335703093*^9, 3.852760344574604*^9}, {
   3.852760492306622*^9, 3.852760516842245*^9}, {3.852760676559518*^9, 
   3.852760687761437*^9}, {3.8527607281268463`*^9, 3.852760745608561*^9}, {
   3.8527608617328253`*^9, 3.85276094066757*^9}, {3.852761832212595*^9, 
   3.8527618815370398`*^9}, 3.85276191925371*^9, {3.852761956503297*^9, 
   3.8527619584860287`*^9}, {3.8527619988379173`*^9, 3.85276206926138*^9}, {
   3.8527622081533623`*^9, 3.852762220580799*^9}, {3.852762294744464*^9, 
   3.852762302557022*^9}, {3.852762361126053*^9, 3.85276239023589*^9}, {
   3.852762496809544*^9, 3.8527625286112957`*^9}, {3.85276279629708*^9, 
   3.852762818156147*^9}, {3.852762896664559*^9, 3.8527628998121758`*^9}, {
   3.852762935408305*^9, 3.852762936839191*^9}, {3.8527630100811768`*^9, 
   3.8527630334666967`*^9}, {3.8527631052760344`*^9, 3.852763122332678*^9}, {
   3.852763216013853*^9, 3.852763229554315*^9}, {3.852763282544448*^9, 
   3.8527632837500687`*^9}, {3.852763328803981*^9, 3.852763338749807*^9}, {
   3.8527633808065*^9, 3.8527633817975807`*^9}, {3.852763453775775*^9, 
   3.8527634558003197`*^9}, {3.852763493538292*^9, 3.852763495907496*^9}, {
   3.852763556937338*^9, 3.852763590609694*^9}, {3.852763697567748*^9, 
   3.852763700415615*^9}, {3.852764033110174*^9, 3.852764051303338*^9}, {
   3.852764146026585*^9, 3.8527641572160892`*^9}, {3.852764220845242*^9, 
   3.852764227904546*^9}, {3.852764268702083*^9, 3.8527642790907373`*^9}, {
   3.85276431918793*^9, 3.852764345582923*^9}, {3.8527644562308493`*^9, 
   3.852764468160677*^9}, {3.852764564693655*^9, 3.8527645984024563`*^9}, {
   3.852764649077731*^9, 3.852764686179083*^9}, {3.8527648089669867`*^9, 
   3.852764813680529*^9}, {3.852764879924631*^9, 3.852764911935912*^9}, {
   3.852764996711486*^9, 3.852764998851512*^9}, {3.852765056401182*^9, 
   3.852765056731161*^9}, 3.8528196685702467`*^9, {3.852819720478609*^9, 
   3.8528197395037737`*^9}, {3.852819894093165*^9, 3.85281989990027*^9}, {
   3.852819940435028*^9, 3.852819953512908*^9}, {3.8528199926081543`*^9, 
   3.852820002064736*^9}, {3.9073585896222677`*^9, 3.907358594867454*^9}, {
   3.907358826886672*^9, 3.907358827598112*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"388f7f74-ab92-47fe-a94e-22675c63e99f"],

Cell[BoxData[{
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/yuchenwang/Workspace/manuscript-sharc/finalfigure1.tiff\>\"", 
   ",", "p1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/yuchenwang/Workspace/manuscript-sharc/finalfigure1.mov\>\"", 
   ",", "pp1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.853601978363155*^9, 3.853601984849609*^9}, {
   3.8536020227492867`*^9, 3.8536020265288258`*^9}, {3.85360212173943*^9, 
   3.853602133165847*^9}, {3.907358813888904*^9, 3.907358823716465*^9}, 
   3.90735886452626*^9, {3.9073590322768307`*^9, 3.90735903295124*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"e096d7f7-aa5a-4ee4-87c5-f61498af53bb"]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"052fccbc-282d-4c6b-b90f-aa354bbe345f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 795, 12, 30, "Input",ExpressionUUID->"32e02df5-b096-4465-93b2-98338af06d33"],
Cell[1356, 34, 3028, 54, 73, "Input",ExpressionUUID->"4e72673f-7a16-4820-9b8a-5d909411c084"],
Cell[4387, 90, 5883, 131, 367, "Input",ExpressionUUID->"1d9c353e-8a9b-44f5-aded-fb9e2bd6a438"],
Cell[10273, 223, 10600, 222, 299, "Input",ExpressionUUID->"63646080-c82a-4dd2-a24d-0055389da5d8"],
Cell[20876, 447, 13574, 292, 362, "Input",ExpressionUUID->"388f7f74-ab92-47fe-a94e-22675c63e99f"],
Cell[34453, 741, 687, 13, 52, "Input",ExpressionUUID->"e096d7f7-aa5a-4ee4-87c5-f61498af53bb"]
}
]
*)

